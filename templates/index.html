{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
  <h1>TON Message Analytics</h1>

  <div class="card mb-4">
    <div class="card-body">
      <h5>Recent Messages</h5>

      {% if messages %}
        <div class="list-group">
          {% for message in messages %}
            <div class="list-group-item">
              <div class="d-flex w-100 justify-content-between">
                <h5 class="mb-1">{{ message.channel_title }}</h5>
                <small>{{ message.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</small>
              </div>
              <p class="mb-1">{{ message.content }}</p>
              <small>
                {% if message.is_ton_dev %}
                  <span class="badge bg-primary">TON DEV</span>
                {% endif %}
                <span class="badge bg-secondary">{{ message.dialog_type }}</span>
              </small>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

  <script>
    // Auto-refresh the page every 30 seconds
    setTimeout(function() {
      window.location.reload();
    }, 30000);
  </script>
</div>
{% endblock %}